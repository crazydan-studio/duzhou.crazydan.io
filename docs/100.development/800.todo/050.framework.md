---
title: 框架开发
description: 框架的功能实现清单及进展
disable_comments: true
custom_edit_url:
---

import {Tasks, Task, Comment} from '@site/src/components/Task';

- 提供对渡舟平台业务能力之下的技术层支持

## v0.1.x {#v0.1}

实现以下基础服务：

- 服务网关：Api 和 Web 资源网关
- 配置中心：
- 认证与鉴权：资源权限与数据权限
- 前后端本地化机制
- [应用建模器](#v0.1-app-modeler)
- ~~[DSL 设计器](#v0.1-dsl-designer)~~：
  优先开发表单形式的设计器，图形化只是应用设计的某种表现形式，不是核心关键

设计与实现要点：

- 抽象与实现分离：以**最小化信息表达**实现
  [框架中立性](/blog/the-framework-agnostic-in-reversible-computation)

### Web 前端 {#v0.1-fe-web}

<Tasks>

<Task status="done" startDate="2024-02-03" endDate="2024-02-17">

实现基于 AMIS 页面渲染引擎的**页面渲染器**（`renderer`）框架，支持根据
`Site` 模型做页面布局

<Comment></Comment>

</Task>

<Task status="done" startDate="2024-02-21" endDate="2024-02-22">

支持对 `@query:` 前缀 URL 的请求和响应处理

<Comment>

调用 `/graphql` 对应端点的查询服务

</Comment>

</Task>

<Task status="hold" startDate="2024-03-09" endDate="">

开发 DSL 编辑组件，用于设计、编辑、显示 DSL

<Comment>

- 编辑器仅识别和处理通用的模型结构，如，`线`、`节点`等
- 基于 [React Flow](https://reactflow.dev/learn) 实现
  DSL 图形绘制和编辑

</Comment>

</Task>

</Tasks>

### 服务后端 {#v0.1-be}

<Tasks>

<Task status="done" startDate="2024-02-03" endDate="2024-02-17">

设计前端站点 `Site` 的 XDef，并实现根据请求 URL
路径匹配不同站点并返回其入口 HTML 页面的能力

<Comment></Comment>

</Task>

<Task status="done" startDate="2024-02-18" endDate="2024-02-23">

提供 GraphQL 接口，解析并获取指定资源页面的结构

<Comment>

- 直接利用 Nop XView 模型（可按需改造）
- 针对 AMIS 的 JSON 结构转换

</Comment>

</Task>

<Task status="doing" startDate="2024-04-05" endDate="">

设计并实现 [应用建模器](#v0.1-app-modeler)

<Comment></Comment>

</Task>

<Task status="pending" startDate="" endDate="">

设计 Delta 版本分层机制，实现从底层到目标层可逐层叠加并最终生成目标版本的完整
DSL 的能力

<Comment>

- 每个 Delta 层的标识为该层所有 DSL 的结构 Hash 值
- 根据当前的语言（`Context#locale`）自动选择并解析指定 DSL
  的对应语言的派生 DSL 文件
- 在支持原生的 Nop Vfs 之外，优先支持数据库方式的存取，并辅助支持文件系统
  - 通过数据库来规避分布式文件系统的部署复杂、数据易损坏和性能低下等问题

</Comment>

</Task>

<Task status="pending" startDate="" endDate="">

根据用户权限对站点、资源、操作和接口做访问控制

<Comment>

- 在前端无不可访问的页面元素
- 在后端禁止绕行访问，无权限的返回
  [403](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403)
- 匿名用户也需显式配置权限，否则，按无权限处理

</Comment>

</Task>

<Task status="pending" startDate="" endDate="">

用户认证和鉴权

<Comment>

- 分为控制层和实现层，前者以过滤器形式控制请求，
  后者为系统提供用户鉴权数据

</Comment>

</Task>

</Tasks>

### 应用建模器 {#v0.1-app-modeler}

<Tasks>

<Task status="doing" startDate="2024-04-05" endDate="">

初步实现 Nop 所支持的 Excel 应用建模的基础功能

<Comment>

- [x] 实现以表单形式设计和管理 ORM 模型
- [ ] 实现按应用服务（Service）生成 Maven 工程代码
- [ ] 实现对建模数据的导入和导出

</Comment>

</Task>

<Task status="pending" startDate="" endDate="">

前端页面复用 Nop XView 的能力，以复用页面组件，并可生成差量

<Comment>

- 在 AMIS Schema 中均附加 `name` 属性，以用于支持差量

</Comment>

</Task>

<Task status="pending" startDate="" endDate="">

对 ORM 模型变更的差量支持

<Comment>

- [ ] 支持数据库表结构的差量更新

</Comment>

</Task>

</Tasks>

### DSL 设计器 {#v0.1-dsl-designer}

<Tasks status="hold">

<Task status="pending" startDate="" endDate="">

扫描并识别在 classpath 和 schema 存储目录中的 XDsl 和 XDef，
根据其结构和依赖关系，并转换为 DSL 设计器可识别的元素（线、节点等）结构

<Comment>

- 即，编写 DSL 读取接口

</Comment>

</Task>

<Task status="pending" startDate="" endDate="">

将 DSL 设计器的元素结构转换为对应 XDsl 或 XDef 定义，
并按照 Delta 分层方式存放定义文件

<Comment>

- 即，编写 DSL 保存接口

</Comment>

</Task>

</Tasks>
